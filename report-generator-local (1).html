<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë³´ê³ ì„œ ìƒì„±ê¸° (ë¡œì»¬ ë²„ì „)</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 30px 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .header-icon {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #ff6b6b, #feca57);
      border-radius: 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .header-icon svg {
      width: 30px;
      height: 30px;
      fill: white;
    }
    
    .header h1 {
      color: white;
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .header p {
      color: rgba(255,255,255,0.8);
      font-size: 1.1rem;
    }
    
    .badge {
      display: inline-block;
      background: rgba(255,255,255,0.2);
      color: white;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.85rem;
      margin-top: 10px;
    }
    
    .main-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
    }
    
    @media (max-width: 900px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .card {
      background: white;
      border-radius: 24px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.15);
    }
    
    .card-title {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 25px;
      font-size: 1.3rem;
      font-weight: 600;
      color: #1a1a2e;
    }
    
    .card-title svg {
      width: 24px;
      height: 24px;
      fill: #667eea;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-size: 0.9rem;
      font-weight: 500;
      color: #555;
    }
    
    .form-group input[type="text"] {
      width: 100%;
      padding: 14px 18px;
      border: 2px solid #e8e8e8;
      border-radius: 12px;
      font-size: 1rem;
      font-family: inherit;
      transition: all 0.3s;
    }
    
    .form-group input[type="text"]:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }
    
    .file-upload {
      border: 2px dashed #d0d0d0;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #fafafa;
    }
    
    .file-upload:hover {
      border-color: #667eea;
      background: #f5f7ff;
    }
    
    .file-upload svg {
      width: 40px;
      height: 40px;
      fill: #667eea;
      margin-bottom: 10px;
    }
    
    .file-upload span {
      color: #666;
      font-size: 0.95rem;
    }
    
    .file-upload input {
      display: none;
    }
    
    textarea {
      width: 100%;
      height: 200px;
      padding: 16px;
      border: 2px solid #e8e8e8;
      border-radius: 12px;
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      transition: all 0.3s;
    }
    
    textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }
    
    .btn-generate {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: all 0.3s;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }
    
    .btn-generate:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5);
    }
    
    .btn-generate:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .btn-generate svg {
      width: 22px;
      height: 22px;
      fill: white;
    }
    
    .error-box {
      background: #fff5f5;
      border: 1px solid #ffcdd2;
      color: #c62828;
      padding: 14px 18px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 0.9rem;
    }
    
    /* Preview Section */
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }
    
    .btn-download {
      padding: 10px 20px;
      background: linear-gradient(135deg, #00b894, #00cec9);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }
    
    .btn-download:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 184, 148, 0.4);
    }
    
    .btn-download svg {
      width: 18px;
      height: 18px;
      fill: white;
    }
    
    .preview-empty {
      height: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #aaa;
    }
    
    .preview-empty svg {
      width: 80px;
      height: 80px;
      fill: #ddd;
      margin-bottom: 15px;
    }
    
    .preview-content {
      max-height: 600px;
      overflow-y: auto;
    }
    
    .preview-content::-webkit-scrollbar {
      width: 8px;
    }
    
    .preview-content::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    .preview-content::-webkit-scrollbar-thumb {
      background: #667eea;
      border-radius: 4px;
    }
    
    /* Report Preview Styles */
    .report-preview-header {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: white;
      padding: 25px;
      border-radius: 16px;
      margin-bottom: 20px;
    }
    
    .report-preview-header h3 {
      font-size: 1.3rem;
      margin-bottom: 15px;
    }
    
    .report-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      font-size: 0.85rem;
      opacity: 0.9;
    }
    
    .preview-box {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
    }
    
    .preview-box h4 {
      color: #667eea;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }
    
    .preview-box p {
      color: #444;
      font-size: 0.95rem;
      line-height: 1.7;
    }
    
    .key-point-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 12px 15px;
      background: white;
      border-radius: 8px;
      margin-bottom: 8px;
      font-size: 0.9rem;
      color: #333;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .key-point-bullet {
      color: #667eea;
      font-size: 1rem;
      flex-shrink: 0;
    }
    
    .section-box {
      background: white;
      border-left: 4px solid #764ba2;
      padding: 18px;
      border-radius: 0 12px 12px 0;
      margin-bottom: 15px;
    }
    
    .section-box h4 {
      color: #1a1a2e;
      font-size: 1rem;
      margin-bottom: 10px;
    }
    
    .section-box p {
      color: #555;
      font-size: 0.9rem;
      line-height: 1.7;
    }
    
    .chart-preview {
      background: #fafafa;
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .chart-preview h4 {
      color: #1a1a2e;
      font-size: 1rem;
      margin-bottom: 20px;
    }
    
    .chart-bars {
      display: flex;
      align-items: flex-end;
      justify-content: center;
      gap: 15px;
      height: 150px;
      margin-bottom: 15px;
    }
    
    .chart-bar-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    
    .chart-bar-value {
      color: #333;
      font-size: 0.85rem;
      font-weight: 600;
    }
    
    .chart-bar {
      width: 50px;
      border-radius: 8px 8px 0 0;
      transition: all 0.5s;
    }
    
    .chart-bar-label {
      color: #666;
      font-size: 0.75rem;
    }
    
    .chart-description {
      color: #888;
      font-size: 0.85rem;
    }
    
    .conclusion-preview {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 15px;
    }
    
    .conclusion-preview h4 {
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    
    .conclusion-preview p {
      font-size: 0.9rem;
      line-height: 1.7;
    }
    
    .keywords-preview {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .keyword-tag {
      background: #f0f4ff;
      color: #667eea;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    
    .spinner {
      width: 22px;
      height: 22px;
      border: 3px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .stat-item {
      background: white;
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: #667eea;
    }
    
    .stat-label {
      font-size: 0.75rem;
      color: #888;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-icon">
        <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h6v6h6v10H6z"/></svg>
      </div>
      <h1>ë³´ê³ ì„œ ìƒì„±ê¸°</h1>
      <p>í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ë©´ ì „ë¬¸ì ì¸ ë³´ê³ ì„œë¡œ ë³€í™˜í•´ ë“œë¦½ë‹ˆë‹¤</p>
      <span class="badge">ğŸ–¥ï¸ ë¡œì»¬ ë²„ì „ (ê·œì¹™ ê¸°ë°˜ ë¶„ì„)</span>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
      <!-- Input Card -->
      <div class="card">
        <div class="card-title">
          <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"/></svg>
          ì…ë ¥
        </div>

        <!-- Author -->
        <div class="form-group">
          <label>ì‘ì„±ìëª…</label>
          <input type="text" id="authorName" placeholder="ë³´ê³ ì„œ ì‘ì„±ì ì´ë¦„">
        </div>

        <!-- Report Title -->
        <div class="form-group">
          <label>ë³´ê³ ì„œ ì œëª© (ì„ íƒ)</label>
          <input type="text" id="reportTitle" placeholder="ìë™ ìƒì„±ë˜ì§€ë§Œ ì§ì ‘ ì…ë ¥ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤">
        </div>

        <!-- File Upload -->
        <div class="form-group">
          <label>íŒŒì¼ ì²¨ë¶€</label>
          <label class="file-upload" id="fileUploadArea">
            <svg viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
            <span id="fileNameDisplay">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì„¸ìš”</span>
            <input type="file" id="fileInput" accept=".txt,.md,.json,.csv">
          </label>
        </div>

        <!-- Text Input -->
        <div class="form-group">
          <label>ë¶„ì„í•  í…ìŠ¤íŠ¸</label>
          <textarea id="inputText" placeholder="ë¶„ì„í•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...

ì˜ˆ: íšŒì˜ë¡, ë³´ê³ ì„œ ì´ˆì•ˆ, ì—°êµ¬ ìë£Œ, ê¸°ì‚¬ ë“±

ğŸ’¡ íŒ: ë” ì¢‹ì€ ë³´ê³ ì„œë¥¼ ìœ„í•´ ì¶©ë¶„í•œ ì–‘ì˜ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”."></textarea>
        </div>

        <!-- Error -->
        <div class="error-box" id="errorBox" style="display: none;"></div>

        <!-- Generate Button -->
        <button class="btn-generate" id="generateBtn">
          <svg viewBox="0 0 24 24"><path d="M7.5 5.6L10 7 8.6 4.5 10 2 7.5 3.4 5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14zM22 2l-2.5 1.4L17 2l1.4 2.5L17 7l2.5-1.4L22 7l-1.4-2.5zm-7.63 5.29a.996.996 0 0 0-1.41 0L1.29 18.96a.996.996 0 0 0 0 1.41l2.34 2.34c.39.39 1.02.39 1.41 0L16.7 11.05a.996.996 0 0 0 0-1.41l-2.33-2.35zm-1.03 5.49l-2.12-2.12 2.44-2.44 2.12 2.12-2.44 2.44z"/></svg>
          ë³´ê³ ì„œ ìƒì„±í•˜ê¸°
        </button>
      </div>

      <!-- Preview Card -->
      <div class="card">
        <div class="preview-header">
          <div class="card-title" style="margin-bottom: 0;">
            <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
            ë¯¸ë¦¬ë³´ê¸°
          </div>
          <button class="btn-download" id="downloadBtn" style="display: none;">
            <svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
            HTML ë‹¤ìš´ë¡œë“œ
          </button>
        </div>

        <!-- Empty State -->
        <div class="preview-empty" id="previewEmpty">
          <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h6v6h6v10H6z"/></svg>
          <p>í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ê³  ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ì„¸ìš”</p>
        </div>

        <!-- Preview Content -->
        <div class="preview-content" id="previewContent" style="display: none;"></div>
      </div>
    </div>
  </div>

  <script>
    let reportData = null;

    // í•œêµ­ì–´ ë¶ˆìš©ì–´ ëª©ë¡
    const stopWords = ['ì´', 'ê·¸', 'ì €', 'ê²ƒ', 'ìˆ˜', 'ë“±', 'ë°', 'ë˜ëŠ”', 'ê·¸ë¦¬ê³ ', 'í•˜ì§€ë§Œ', 'ê·¸ëŸ¬ë‚˜', 'ë•Œë¬¸ì—', 'ìœ„í•´', 'í†µí•´', 'ëŒ€í•´', 'ìˆë‹¤', 'ì—†ë‹¤', 'í•˜ë‹¤', 'ë˜ë‹¤', 'ì´ë‹¤', 'ìˆëŠ”', 'ì—†ëŠ”', 'í•˜ëŠ”', 'ë˜ëŠ”', 'ëœ', 'í• ', 'ë ', 'í•¨', 'ë¨', 'ì„', 'ë¥¼', 'ì´', 'ê°€', 'ì€', 'ëŠ”', 'ì˜', 'ì—', 'ì—ì„œ', 'ë¡œ', 'ìœ¼ë¡œ', 'ì™€', 'ê³¼', 'ë„', 'ë§Œ', 'ê¹Œì§€', 'ë¶€í„°', 'ë³´ë‹¤', 'ì²˜ëŸ¼', 'ê°™ì´'];

    // File Upload
    document.getElementById('fileInput').addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;
      
      document.getElementById('fileNameDisplay').textContent = file.name;
      
      if (file.type === 'text/plain' || file.name.endsWith('.txt') || file.name.endsWith('.md') || file.name.endsWith('.json') || file.name.endsWith('.csv')) {
        const text = await file.text();
        document.getElementById('inputText').value = text;
      }
    });

    // í…ìŠ¤íŠ¸ ë¶„ì„ í•¨ìˆ˜ë“¤
    function analyzeText(text) {
      // ê¸°ë³¸ í†µê³„
      const sentences = text.split(/[.!?ã€‚]\s*/).filter(s => s.trim().length > 0);
      const words = text.split(/\s+/).filter(w => w.length > 0);
      const paragraphs = text.split(/\n\n+/).filter(p => p.trim().length > 0);
      const characters = text.replace(/\s/g, '').length;
      
      return {
        sentenceCount: sentences.length,
        wordCount: words.length,
        paragraphCount: paragraphs.length,
        characterCount: characters,
        sentences: sentences,
        words: words,
        paragraphs: paragraphs
      };
    }

    function extractKeywords(text, topN = 10) {
      // ë‹¨ì–´ ë¹ˆë„ ë¶„ì„
      const words = text.toLowerCase()
        .replace(/[^\w\sã„±-ã…ã…-ã…£ê°€-í£]/g, ' ')
        .split(/\s+/)
        .filter(w => w.length > 1 && !stopWords.includes(w));
      
      const frequency = {};
      words.forEach(word => {
        frequency[word] = (frequency[word] || 0) + 1;
      });
      
      return Object.entries(frequency)
        .sort((a, b) => b[1] - a[1])
        .slice(0, topN)
        .map(([word, count]) => ({ word, count }));
    }

    function generateTitle(text, customTitle) {
      if (customTitle && customTitle.trim()) {
        return customTitle.trim();
      }
      
      const keywords = extractKeywords(text, 3);
      if (keywords.length > 0) {
        const mainKeywords = keywords.map(k => k.word).join(', ');
        return `${mainKeywords} ë¶„ì„ ë³´ê³ ì„œ`;
      }
      return 'í…ìŠ¤íŠ¸ ë¶„ì„ ë³´ê³ ì„œ';
    }

    function generateSummary(text, stats) {
      const firstSentences = stats.sentences.slice(0, 3).join('. ');
      const summary = `ì´ ë¬¸ì„œëŠ” ì´ ${stats.paragraphCount}ê°œì˜ ë‹¨ë½, ${stats.sentenceCount}ê°œì˜ ë¬¸ì¥, ${stats.wordCount}ê°œì˜ ë‹¨ì–´ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ${firstSentences.substring(0, 200)}...`;
      return summary;
    }

    function extractKeyPoints(text, stats) {
      // ì¤‘ìš” ë¬¸ì¥ ì¶”ì¶œ (ê¸¸ì´ì™€ í‚¤ì›Œë“œ ê¸°ë°˜)
      const keywords = extractKeywords(text, 5).map(k => k.word);
      
      const scoredSentences = stats.sentences.map(sentence => {
        let score = 0;
        // ê¸¸ì´ ì ìˆ˜ (ë„ˆë¬´ ì§§ê±°ë‚˜ ê¸¸ì§€ ì•Šì€ ë¬¸ì¥ ì„ í˜¸)
        if (sentence.length > 20 && sentence.length < 150) score += 2;
        // í‚¤ì›Œë“œ í¬í•¨ ì ìˆ˜
        keywords.forEach(kw => {
          if (sentence.toLowerCase().includes(kw)) score += 3;
        });
        // ìˆ«ì í¬í•¨ ì ìˆ˜ (ë°ì´í„° í¬í•¨ ê°€ëŠ¥ì„±)
        if (/\d+/.test(sentence)) score += 2;
        
        return { sentence, score };
      });
      
      return scoredSentences
        .sort((a, b) => b.score - a.score)
        .slice(0, 5)
        .map(s => s.sentence.trim())
        .filter(s => s.length > 10);
    }

    function generateSections(text, stats) {
      const sections = [];
      
      // ê°œìš” ì„¹ì…˜
      sections.push({
        heading: 'ë¬¸ì„œ ê°œìš”',
        content: `ë³¸ ë¬¸ì„œëŠ” ${stats.characterCount}ìì˜ í…ìŠ¤íŠ¸ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ${stats.paragraphCount}ê°œì˜ ë‹¨ë½ìœ¼ë¡œ ë‚˜ë‰˜ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. ì „ì²´ì ìœ¼ë¡œ ${stats.sentenceCount}ê°œì˜ ë¬¸ì¥ì´ í¬í•¨ë˜ì–´ ìˆì–´ ${stats.sentenceCount > 20 ? 'ìƒì„¸í•œ' : 'ê°„ëµí•œ'} ë‚´ìš©ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.`
      });
      
      // ì£¼ìš” ë‚´ìš© ì„¹ì…˜
      const mainParagraphs = stats.paragraphs.slice(0, 2);
      if (mainParagraphs.length > 0) {
        sections.push({
          heading: 'ì£¼ìš” ë‚´ìš©',
          content: mainParagraphs.map(p => p.substring(0, 300)).join(' ').substring(0, 500) + '...'
        });
      }
      
      // í‚¤ì›Œë“œ ë¶„ì„ ì„¹ì…˜
      const keywords = extractKeywords(text, 5);
      if (keywords.length > 0) {
        const keywordAnalysis = keywords.map(k => `"${k.word}"(${k.count}íšŒ)`).join(', ');
        sections.push({
          heading: 'í•µì‹¬ í‚¤ì›Œë“œ ë¶„ì„',
          content: `ë¬¸ì„œì—ì„œ ê°€ì¥ ìì£¼ ë“±ì¥í•˜ëŠ” í‚¤ì›Œë“œëŠ” ${keywordAnalysis} ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ í‚¤ì›Œë“œë“¤ì€ ë¬¸ì„œì˜ ì£¼ì œì™€ í•µì‹¬ ë‚´ìš©ì„ ë°˜ì˜í•©ë‹ˆë‹¤.`
        });
      }
      
      return sections;
    }

    function generateChartData(text) {
      const keywords = extractKeywords(text, 5);
      
      if (keywords.length >= 3) {
        return {
          type: 'bar',
          title: 'ì£¼ìš” í‚¤ì›Œë“œ ë¹ˆë„ ë¶„ì„',
          labels: keywords.slice(0, 5).map(k => k.word),
          values: keywords.slice(0, 5).map(k => k.count),
          description: 'ë¬¸ì„œì—ì„œ ê°€ì¥ ë§ì´ ì–¸ê¸‰ëœ í‚¤ì›Œë“œì™€ ê·¸ ë¹ˆë„ìˆ˜ì…ë‹ˆë‹¤.'
        };
      }
      
      // ê¸°ë³¸ ì°¨íŠ¸ ë°ì´í„°
      const stats = analyzeText(text);
      return {
        type: 'bar',
        title: 'ë¬¸ì„œ êµ¬ì„± ë¶„ì„',
        labels: ['ë‹¨ë½', 'ë¬¸ì¥', 'ë‹¨ì–´(x10)'],
        values: [stats.paragraphCount, stats.sentenceCount, Math.round(stats.wordCount / 10)],
        description: 'ë¬¸ì„œì˜ êµ¬ì¡°ì  êµ¬ì„± ìš”ì†Œë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.'
      };
    }

    function generateConclusion(text, stats, keywords) {
      const topKeywords = keywords.slice(0, 3).map(k => k.word).join(', ');
      return `ë³¸ ë¬¸ì„œëŠ” "${topKeywords}" ë“±ì˜ ì£¼ì œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ${stats.wordCount}ê°œì˜ ë‹¨ì–´ì™€ ${stats.sentenceCount}ê°œì˜ ë¬¸ì¥ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ${stats.paragraphCount > 5 ? 'ìƒì„¸í•˜ê³  ê¹Šì´ ìˆëŠ”' : 'ê°„ê²°í•˜ê³  í•µì‹¬ì ì¸'} ë‚´ìš©ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ì ì¸ ë¶„ì„ì´ë‚˜ ì„¸ë¶€ ê²€í† ê°€ í•„ìš”í•œ ê²½ìš° ì›ë¬¸ì„ ì°¸ì¡°í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.`;
    }

    // Generate Report
    document.getElementById('generateBtn').addEventListener('click', () => {
      const inputText = document.getElementById('inputText').value.trim();
      const authorName = document.getElementById('authorName').value.trim() || 'ì‘ì„±ì ë¯¸ì§€ì •';
      const customTitle = document.getElementById('reportTitle').value.trim();
      const errorBox = document.getElementById('errorBox');
      
      if (!inputText) {
        errorBox.textContent = 'ë¶„ì„í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        errorBox.style.display = 'block';
        return;
      }
      
      if (inputText.length < 50) {
        errorBox.textContent = 'ë” ì •í™•í•œ ë¶„ì„ì„ ìœ„í•´ ìµœì†Œ 50ì ì´ìƒì˜ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        errorBox.style.display = 'block';
        return;
      }
      
      errorBox.style.display = 'none';
      
      // í…ìŠ¤íŠ¸ ë¶„ì„
      const stats = analyzeText(inputText);
      const keywords = extractKeywords(inputText, 10);
      
      // ë³´ê³ ì„œ ë°ì´í„° ìƒì„±
      reportData = {
        title: generateTitle(inputText, customTitle),
        summary: generateSummary(inputText, stats),
        keyPoints: extractKeyPoints(inputText, stats),
        sections: generateSections(inputText, stats),
        chartData: generateChartData(inputText),
        conclusion: generateConclusion(inputText, stats, keywords),
        keywords: keywords.slice(0, 6).map(k => k.word),
        stats: stats,
        author: authorName,
        date: new Date().toLocaleDateString('ko-KR', { 
          year: 'numeric', 
          month: 'long', 
          day: 'numeric' 
        }),
        sourceFile: document.getElementById('fileNameDisplay').textContent !== 'íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì„¸ìš”' 
          ? document.getElementById('fileNameDisplay').textContent 
          : 'ì§ì ‘ ì…ë ¥'
      };
      
      renderPreview();
      document.getElementById('downloadBtn').style.display = 'flex';
    });

    // Render Preview
    function renderPreview() {
      document.getElementById('previewEmpty').style.display = 'none';
      const previewContent = document.getElementById('previewContent');
      previewContent.style.display = 'block';
      
      const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe'];
      const maxValue = Math.max(...reportData.chartData.values);
      
      let chartHTML = `
        <div class="chart-bars">
          ${reportData.chartData.values.map((val, i) => `
            <div class="chart-bar-item">
              <span class="chart-bar-value">${val}</span>
              <div class="chart-bar" style="height: ${(val / maxValue) * 120}px; background: ${colors[i % colors.length]};"></div>
              <span class="chart-bar-label">${reportData.chartData.labels[i]}</span>
            </div>
          `).join('')}
        </div>
      `;
      
      previewContent.innerHTML = `
        <div class="report-preview-header">
          <h3>${reportData.title}</h3>
          <div class="report-meta">
            <span>ğŸ“ ${reportData.author}</span>
            <span>ğŸ“… ${reportData.date}</span>
            <span>ğŸ“ ${reportData.sourceFile}</span>
          </div>
        </div>
        
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value">${reportData.stats.paragraphCount}</div>
            <div class="stat-label">ë‹¨ë½</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${reportData.stats.sentenceCount}</div>
            <div class="stat-label">ë¬¸ì¥</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">${reportData.stats.wordCount}</div>
            <div class="stat-label">ë‹¨ì–´</div>
          </div>
        </div>
        
        <div class="preview-box">
          <h4>ğŸ“‹ ìš”ì•½</h4>
          <p>${reportData.summary}</p>
        </div>
        
        <div class="preview-box">
          <h4>ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸</h4>
          ${reportData.keyPoints.map(point => `<div class="key-point-item"><span class="key-point-bullet">âœ¦</span>${point}</div>`).join('')}
        </div>
        
        ${reportData.sections.map(section => `
          <div class="section-box">
            <h4>${section.heading}</h4>
            <p>${section.content}</p>
          </div>
        `).join('')}
        
        <div class="chart-preview">
          <h4>ğŸ“Š ${reportData.chartData.title}</h4>
          ${chartHTML}
          <p class="chart-description">${reportData.chartData.description}</p>
        </div>
        
        <div class="conclusion-preview">
          <h4>ğŸ’¡ ê²°ë¡  ë° ì œì•ˆ</h4>
          <p>${reportData.conclusion}</p>
        </div>
        
        <div class="keywords-preview">
          ${reportData.keywords.map(kw => `<span class="keyword-tag">#${kw}</span>`).join('')}
        </div>
      `;
    }

    // Download Report
    document.getElementById('downloadBtn').addEventListener('click', () => {
      if (!reportData) return;
      
      const chartSVG = generateChartSVG(reportData.chartData);
      
      const htmlContent = `<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${reportData.title}</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
      padding: 40px 20px;
    }
    .report-container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .report-header {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: white;
      padding: 50px 40px;
      position: relative;
      overflow: hidden;
    }
    .report-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -20%;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(102, 126, 234, 0.3) 0%, transparent 70%);
      border-radius: 50%;
    }
    .report-header h1 {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 20px;
      position: relative;
      line-height: 1.3;
    }
    .meta-info {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      font-size: 0.95rem;
      opacity: 0.9;
      position: relative;
    }
    .report-body { padding: 50px 40px; background: white; }
    
    .stats-row {
      display: flex;
      gap: 20px;
      margin-bottom: 40px;
    }
    .stat-box {
      flex: 1;
      background: #f8f9ff;
      border-radius: 16px;
      padding: 25px;
      text-align: center;
    }
    .stat-box .value {
      font-size: 2.5rem;
      font-weight: 700;
      color: #667eea;
    }
    .stat-box .label {
      color: #888;
      font-size: 0.9rem;
      margin-top: 5px;
    }
    
    .summary-box {
      background: #f8f9ff;
      border-left: 5px solid #667eea;
      padding: 30px;
      border-radius: 0 16px 16px 0;
      margin-bottom: 40px;
    }
    .summary-box h2 {
      color: #667eea;
      font-size: 1.1rem;
      margin-bottom: 15px;
    }
    .summary-box p {
      color: #444;
      line-height: 1.8;
      font-size: 1.05rem;
    }
    
    .key-points {
      background: #fafafa;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 40px;
    }
    .key-points h2 {
      color: #1a1a2e;
      font-size: 1.3rem;
      margin-bottom: 20px;
    }
    .key-points ul { list-style: none; }
    .key-points li {
      padding: 15px 20px;
      background: white;
      border-radius: 10px;
      margin-bottom: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      display: flex;
      align-items: center;
      gap: 15px;
      color: #333;
      line-height: 1.6;
    }
    .key-points li::before {
      content: 'âœ¦';
      color: #667eea;
      font-size: 1.2rem;
    }
    
    .section {
      margin-bottom: 35px;
      padding-bottom: 35px;
      border-bottom: 1px solid #eee;
    }
    .section h3 {
      color: #1a1a2e;
      font-size: 1.4rem;
      margin-bottom: 15px;
      padding-left: 15px;
      border-left: 4px solid #764ba2;
    }
    .section p {
      color: #555;
      line-height: 1.9;
      font-size: 1.05rem;
    }
    
    .chart-container {
      background: #fafafa;
      border-radius: 20px;
      padding: 40px;
      margin: 40px 0;
      text-align: center;
    }
    .chart-container h2 {
      color: #1a1a2e;
      font-size: 1.3rem;
      margin-bottom: 30px;
    }
    .chart-svg { width: 100%; max-width: 500px; margin: 0 auto; display: block; }
    .chart-description {
      margin-top: 20px;
      color: #666;
      font-size: 0.95rem;
    }
    
    .conclusion-box {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 35px;
      border-radius: 16px;
      margin: 40px 0;
    }
    .conclusion-box h2 {
      font-size: 1.2rem;
      margin-bottom: 15px;
    }
    .conclusion-box p { line-height: 1.8; font-size: 1.05rem; }
    
    .keywords {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 30px;
    }
    .keyword {
      background: #f0f4ff;
      color: #667eea;
      padding: 8px 18px;
      border-radius: 25px;
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    .footer {
      text-align: center;
      padding: 30px;
      background: #fafafa;
      color: #888;
      font-size: 0.85rem;
    }
    
    @media print {
      body { background: white; padding: 0; }
      .report-container { box-shadow: none; }
    }
  </style>
</head>
<body>
  <div class="report-container">
    <header class="report-header">
      <h1>${reportData.title}</h1>
      <div class="meta-info">
        <span>ğŸ“ ì‘ì„±ì: ${reportData.author}</span>
        <span>ğŸ“… ì‘ì„±ì¼: ${reportData.date}</span>
        <span>ğŸ“ ì›ë³¸: ${reportData.sourceFile}</span>
      </div>
    </header>
    
    <div class="report-body">
      <div class="stats-row">
        <div class="stat-box">
          <div class="value">${reportData.stats.paragraphCount}</div>
          <div class="label">ë‹¨ë½</div>
        </div>
        <div class="stat-box">
          <div class="value">${reportData.stats.sentenceCount}</div>
          <div class="label">ë¬¸ì¥</div>
        </div>
        <div class="stat-box">
          <div class="value">${reportData.stats.wordCount}</div>
          <div class="label">ë‹¨ì–´</div>
        </div>
      </div>
    
      <div class="summary-box">
        <h2>ğŸ“‹ ìš”ì•½</h2>
        <p>${reportData.summary}</p>
      </div>
      
      <div class="key-points">
        <h2>ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸</h2>
        <ul>
          ${reportData.keyPoints.map(point => `<li>${point}</li>`).join('')}
        </ul>
      </div>
      
      ${reportData.sections.map(section => `
        <div class="section">
          <h3>${section.heading}</h3>
          <p>${section.content}</p>
        </div>
      `).join('')}
      
      <div class="chart-container">
        <h2>ğŸ“Š ${reportData.chartData.title}</h2>
        ${chartSVG}
        <p class="chart-description">${reportData.chartData.description}</p>
      </div>
      
      <div class="conclusion-box">
        <h2>ğŸ’¡ ê²°ë¡  ë° ì œì•ˆ</h2>
        <p>${reportData.conclusion}</p>
      </div>
      
      <div class="keywords">
        ${reportData.keywords.map(kw => `<span class="keyword">#${kw}</span>`).join('')}
      </div>
    </div>
    
    <footer class="footer">
      ì´ ë³´ê³ ì„œëŠ” í…ìŠ¤íŠ¸ ë¶„ì„ ì‹œìŠ¤í…œìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
    </footer>
  </div>
</body>
</html>`;

      const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${reportData.title.replace(/[^a-zA-Z0-9ê°€-í£]/g, '_')}_ë³´ê³ ì„œ.html`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });

    function generateChartSVG(chartData) {
      const { labels, values } = chartData;
      const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe'];
      const maxValue = Math.max(...values);
      
      const barWidth = 60;
      const gap = 30;
      const chartWidth = labels.length * (barWidth + gap);
      const chartHeight = 200;
      
      return `<svg class="chart-svg" viewBox="0 0 ${chartWidth + 40} ${chartHeight + 60}" xmlns="http://www.w3.org/2000/svg">
        ${values.map((val, i) => {
          const barHeight = (val / maxValue) * chartHeight;
          const x = 20 + i * (barWidth + gap);
          return `
            <rect x="${x}" y="${chartHeight - barHeight + 10}" width="${barWidth}" height="${barHeight}" fill="${colors[i % colors.length]}" rx="6"/>
            <text x="${x + barWidth/2}" y="${chartHeight + 35}" text-anchor="middle" fill="#333" font-size="12">${labels[i]}</text>
            <text x="${x + barWidth/2}" y="${chartHeight - barHeight}" text-anchor="middle" fill="#333" font-size="14" font-weight="bold">${val}</text>
          `;
        }).join('')}
      </svg>`;
    }
  </script>
</body>
</html>
